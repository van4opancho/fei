var forms=document.querySelectorAll(".lt-form"),lt_url="undefined"!=typeof lt_link?lt_link:"https://leadtrade.ru",aim=void 0!==aim?aim:1,pastes=[];function leadtradeFormSubmit(e){e.preventDefault();var t=this.querySelector("input[name=name]");if(t)var n=t.value;var r=this.querySelector("input[name=phone]");if(r)var i=r.value;var a=this.querySelector("[name=aim]");a&&(aim=a.value);var u=10,o="Необходимо ввести номер телефона, минимум 10 цифр";if(a&&"SELECT"===a.tagName){var l=a.selectedOptions[0].innerHTML;/[а-яА-Я]/.test(l)||(u=9,o="Please enter 9 digits minimum (without country code) or 11-12 digits (with country code)")}if(i.length<u)return alert(o),!1;var s=this.querySelector("input[name=comment],input[name=comments]"),d="";s&&(d=s.value);var p=this.querySelector("input[name=productsum]"),c=0;p&&(c=p.value);var m="undefined"!=typeof lt_landing_id?lt_landing_id:0,f=null!=this.querySelector("input[name=subid1]")?this.querySelector("input[name=subid1]").value:"",y=null!=this.querySelector("input[name=subid2]")?this.querySelector("input[name=subid2]").value:"",h=null!=this.querySelector("input[name=subid3]")?this.querySelector("input[name=subid3]").value:"",v=null!=this.querySelector("input[name=subid4]")?this.querySelector("input[name=subid4]").value:"",b=this,g={};["address","index","city","email"].forEach(function(e){g[e]=null!=b.querySelector("input[name="+e+"]")?b.querySelector("input[name="+e+"]").value:""});var _={hash:hash,landing_id:m,subid1:getQueryVariable("subid1",f),subid2:getQueryVariable("subid2",y),subid3:getQueryVariable("subid3",h),subid4:getQueryVariable("subid4",v),ip:!1,name:n,phone:i,productsum:c,type:"undefined"!=typeof lt_type?lt_type:"",comment:d,pastes:JSON.stringify(pastes),data:g};return void 0!==aim&&(_.aim=aim),document.querySelectorAll("input[name*=description]").forEach(function(e,t){_[e.name]=e.value}),request("POST",lt_url+"/api/send_lead",_,function(e,t){var r=JSON.parse(e),a=document.createElement("form"),u="undefined"!=typeof success_page?success_page:lt_url+"/landing/success",o="undefined"!=typeof failure_page?failure_page:lt_url+"/landing/fail";"Spam"===r.error?a.setAttribute("action",o):a.setAttribute("action",u);var l,s="post";"undefined"!=typeof lt_html_version&&(s="get"),a.setAttribute("method",s);var d={tracking:r.lead,number:r.mm_number,order_name:n,order_phone:i,aim:aim,landing_id:m};for(var p in d)(l=document.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name",p),l.value=d[p],a.appendChild(l);document.body.appendChild(a),a.submit()}),!1}function request(e,t,n,r){var i=new XMLHttpRequest;i.open(e,t),"POST"==e&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=function(){200==i.status?r(i.responseText,i):alert("Не удалось получить данные")},i.send(http_build_query(n))}function requestJSON(e,t,n,r){var i=new XMLHttpRequest;i.open(e,t),i.onload=function(){200==i.status?r(JSON.parse(i.responseText),i):alert("Не удалось получить данные")},i.send(JSON.stringify(n))}function getQueryVariable(e,t){for(var n=window.location.search.substring(1).split("&"),r=0;r<n.length;r++){var i=n[r].split("=");if(i[0]===e)return i[1]}return t}function http_build_query(e,t,n){var r,i,a=function(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},u=[],o=function(e,t,n){var r,i=[];if(!0===t?t="1":!1===t&&(t="0"),null!==t){if("object"==typeof t){for(r in t)null!==t[r]&&i.push(o(e+"["+r+"]",t[r],n));return i.join(n)}if("function"!=typeof t)return a(e)+"="+a(t);throw new Error("There was an error processing for http_build_query().")}return""};for(i in n||(n="&"),e){r=e[i],t&&!isNaN(i)&&(i=String(t)+i);var l=o(i,r,n);""!==l&&u.push(l)}return u.join(n)}function onPaste(e){var t=e.target.tagName,n=e.target.getAttribute("name");pastes.push({name:n,tag:t})}forms.forEach(function(e,t){e.addEventListener("submit",leadtradeFormSubmit)}),document.body.addEventListener("paste",onPaste);